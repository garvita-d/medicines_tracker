<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Medicine Reminder System</title>
    <meta name="theme-color" content="#4F46E5">
    <link rel="manifest" href="data:application/json;base64,eyJuYW1lIjoiTWVkaWNpbmUgUmVtaW5kZXIgU3lzdGVtIiwic2hvcnRfbmFtZSI6Ik1lZFJlbWluZGVyIiwic3RhcnRfdXJsIjoiLyIsImRpc3BsYXkiOiJzdGFuZGFsb25lIiwiYmFja2dyb3VuZF9jb2xvciI6IiNGRkZGRkYiLCJ0aGVtZV9jb2xvciI6IiM0RjQ2RTUiLCJpY29ucyI6W3sic3JjIjoiZGF0YTppbWFnZS9zdmcreG1sO2Jhc2U2NCxQSE4yWnlCM2FXUjBhRDBpTWpRaUlHaGxhV2QwZEQwaU1qUWlJSFpwWlhkQ2IzZzlJakFnTUNBeU5DQXlOQ0lnWm1sc2JEMGlJelEyTmpreVJTSStQR05wY21Oc1pTQmplRDBpTVRJaUlHTjVQU0l4TWlJZ2NqMGlOU0lnWm1sc2JEMGlJekZHUXpjelFTSXZQand2YzNablBnPT0iLCJzaXplcyI6IjE5MngxOTIiLCJ0eXBlIjoiaW1hZ2Uvc3ZnK3htbCJ9XX0=">
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            color: #333;
            overflow-x: hidden;
        }

        .container {
            max-width: 100%;
            padding: 20px;
            margin: 0 auto;
        }

        .header {
            text-align: center;
            margin-bottom: 30px;
            color: white;
            background: rgba(255,255,255,0.1);
            padding: 20px;
            border-radius: 20px;
            backdrop-filter: blur(10px);
        }

        .header h1 {
            font-size: 2rem;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }

        .tabs {
            display: flex;
            justify-content: center;
            margin-bottom: 20px;
            background: rgba(255,255,255,0.1);
            border-radius: 15px;
            padding: 5px;
            backdrop-filter: blur(10px);
        }

        .tab {
            flex: 1;
            padding: 12px 20px;
            border: none;
            background: transparent;
            color: white;
            cursor: pointer;
            border-radius: 10px;
            font-weight: 600;
            transition: all 0.3s ease;
        }

        .tab.active {
            background: linear-gradient(45deg, #FF6B6B, #4ECDC4);
            box-shadow: 0 4px 15px rgba(0,0,0,0.2);
            transform: translateY(-2px);
        }

        .person-section {
            display: none;
            animation: fadeIn 0.5s ease-in;
        }

        .person-section.active {
            display: block;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .time-slot {
            background: rgba(255,255,255,0.95);
            border-radius: 20px;
            padding: 25px;
            margin-bottom: 20px;
            box-shadow: 0 8px 32px rgba(0,0,0,0.1);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255,255,255,0.2);
        }

        .time-slot h3 {
            color: #4F46E5;
            margin-bottom: 15px;
            font-size: 1.4rem;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .medicine-item {
            background: linear-gradient(45deg, #f8f9ff, #e8eeff);
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 15px;
            border-left: 5px solid #4F46E5;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .medicine-item:hover {
            transform: translateX(5px);
            box-shadow: 0 5px 20px rgba(79, 70, 229, 0.2);
        }

        .medicine-item.low-stock {
            border-left-color: #EF4444;
            background: linear-gradient(45deg, #fff5f5, #fee2e2);
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.02); }
        }

        .medicine-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
        }

        .medicine-name {
            font-weight: 700;
            font-size: 1.1rem;
            color: #1F2937;
        }

        .stock-count {
            background: linear-gradient(45deg, #10B981, #059669);
            color: white;
            padding: 8px 15px;
            border-radius: 25px;
            font-weight: bold;
            font-size: 0.9rem;
            box-shadow: 0 2px 10px rgba(16, 185, 129, 0.3);
        }

        .stock-count.low {
            background: linear-gradient(45deg, #EF4444, #DC2626);
            animation: shake 0.5s ease-in-out;
        }

        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-5px); }
            75% { transform: translateX(5px); }
        }

        .medicine-details {
            color: #6B7280;
            margin-bottom: 15px;
            font-size: 0.95rem;
        }

        .action-buttons {
            display: flex;
            gap: 10px;
        }

        .btn {
            padding: 12px 20px;
            border: none;
            border-radius: 25px;
            cursor: pointer;
            font-weight: 600;
            font-size: 0.9rem;
            transition: all 0.3s ease;
            flex: 1;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }

        .btn-take {
            background: linear-gradient(45deg, #10B981, #059669);
            color: white;
            box-shadow: 0 4px 15px rgba(16, 185, 129, 0.3);
        }

        .btn-take:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(16, 185, 129, 0.4);
        }

        .btn-calendar {
            background: linear-gradient(45deg, #8B5CF6, #7C3AED);
            color: white;
            box-shadow: 0 4px 15px rgba(139, 92, 246, 0.3);
        }

        .btn-calendar:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(139, 92, 246, 0.4);
        }

        .voice-assistant {
            position: fixed;
            bottom: 20px;
            right: 20px;
            width: 60px;
            height: 60px;
            background: linear-gradient(45deg, #FF6B6B, #4ECDC4);
            border-radius: 50%;
            border: none;
            box-shadow: 0 8px 25px rgba(0,0,0,0.2);
            cursor: pointer;
            transition: all 0.3s ease;
            z-index: 1000;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
        }

        .voice-assistant:hover {
            transform: scale(1.1);
            box-shadow: 0 10px 30px rgba(0,0,0,0.3);
        }

        .voice-assistant.listening {
            animation: pulse-voice 1s infinite;
        }

        @keyframes pulse-voice {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.1); }
        }

        .reset-btn {
            position: fixed;
            bottom: 20px;
            left: 20px;
            background: linear-gradient(45deg, #EF4444, #DC2626);
            color: white;
            border: none;
            padding: 15px 20px;
            border-radius: 25px;
            cursor: pointer;
            font-weight: 600;
            box-shadow: 0 4px 15px rgba(239, 68, 68, 0.3);
            transition: all 0.3s ease;
            z-index: 1000;
        }

        .reset-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(239, 68, 68, 0.4);
        }

        .voice-output {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: rgba(0,0,0,0.9);
            color: white;
            padding: 30px;
            border-radius: 20px;
            backdrop-filter: blur(10px);
            z-index: 2000;
            display: none;
            max-width: 90%;
            text-align: center;
        }

        .install-prompt {
            background: linear-gradient(45deg, #FF6B6B, #4ECDC4);
            color: white;
            padding: 15px;
            text-align: center;
            border-radius: 10px;
            margin-bottom: 20px;
            display: none;
            box-shadow: 0 4px 15px rgba(0,0,0,0.2);
        }

        .install-btn {
            background: rgba(255,255,255,0.2);
            color: white;
            border: 2px solid white;
            padding: 10px 20px;
            border-radius: 25px;
            cursor: pointer;
            font-weight: 600;
            margin: 10px;
            transition: all 0.3s ease;
        }

        .install-btn:hover {
            background: white;
            color: #FF6B6B;
            transform: translateY(-2px);
        }

        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            background: linear-gradient(45deg, #10B981, #059669);
            color: white;
            padding: 15px 25px;
            border-radius: 10px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.2);
            z-index: 2000;
            transform: translateX(400px);
            transition: all 0.3s ease;
        }

        .notification.show {
            transform: translateX(0);
        }

        .notification.error {
            background: linear-gradient(45deg, #EF4444, #DC2626);
        }

        @media (max-width: 768px) {
            .container { padding: 15px; }
            .header h1 { font-size: 1.5rem; }
            .medicine-header { flex-direction: column; align-items: flex-start; gap: 10px; }
            .action-buttons { flex-direction: column; }
            .tabs { flex-direction: column; }
            .tab { margin-bottom: 5px; }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="install-prompt" id="installPrompt">
            <h3>üì± Add to Home Screen</h3>
            <p>Install this app on your phone for easy access!</p>
            <button class="install-btn" onclick="showInstallInstructions()">Show Instructions</button>
            <button class="install-btn" onclick="hideInstallPrompt()">Later</button>
        </div>

        <div class="header">
            <h1>üíä Medicine Reminder System</h1>
            <p>Never miss your medication again!</p>
        </div>

        <div class="tabs">
            <button class="tab active" onclick="switchTab('father')">üë®‚Äç‚öïÔ∏è Father</button>
            <button class="tab" onclick="switchTab('mother')">üë©‚Äç‚öïÔ∏è Mother</button>
            <button class="tab" onclick="switchTab('chat')">ü§ñ Voice Assistant</button>
        </div>

        <div id="father" class="person-section active">
            <!-- Father's medicines will be populated by JavaScript -->
        </div>

        <div id="mother" class="person-section">
            <!-- Mother's medicines will be populated by JavaScript -->
        </div>

        <div id="chat" class="person-section">
            <div class="time-slot">
                <h3>ü§ñ Voice Assistant</h3>
                <p>Click the voice button to interact with your medicine assistant. You can:</p>
                <ul style="margin: 20px 0; color: #6B7280; line-height: 1.6;">
                    <li>‚Ä¢ Check medicine stock levels</li>
                    <li>‚Ä¢ Ask about dosage information</li>
                    <li>‚Ä¢ Get reminders for specific medicines</li>
                    <li>‚Ä¢ Inquire about medicine interactions</li>
                    <li>‚Ä¢ Get general medical advice</li>
                </ul>
                <div style="background: linear-gradient(45deg, #f0f9ff, #e0f2fe); padding: 20px; border-radius: 15px; margin-top: 20px;">
                    <h4 style="color: #0369a1; margin-bottom: 10px;">Example Commands:</h4>
                    <p style="color: #6B7280; font-style: italic;">
                        "Check father's medicine stock"<br>
                        "What is Metolol used for?"<br>
                        "Remind me about evening medicines"<br>
                        "How many Acitrom tablets are left?"
                    </p>
                </div>
            </div>
        </div>
    </div>

    <button class="voice-assistant" onclick="toggleVoiceAssistant()" id="voiceBtn">üé§</button>
    <button class="reset-btn" onclick="resetAllStock()">üîÑ Reset Stock</button>

    <div class="voice-output" id="voiceOutput">
        <h3>üé§ Voice Assistant</h3>
        <p id="voiceText">Listening...</p>
        <button onclick="closeVoiceOutput()" style="background: #4F46E5; color: white; border: none; padding: 10px 20px; border-radius: 20px; margin-top: 15px; cursor: pointer;">Close</button>
    </div>

    <div class="notification" id="notification"></div>

    <script>
        // Medicine data structure
        const medicineData = {
            father: {
                morning: [
                    { name: "Maxi PhD", dose: "30 days tablets", timing: "Before breakfast", stock: 30, originalStock: 30 }
                ],
                afterBreakfast: [
                    { name: "Metolol MF", dose: "60mg", timing: "30 days tablets", stock: 30, originalStock: 30 },
                    { name: "Pilclop", dose: "75mg", timing: "30 days tablets", stock: 30, originalStock: 30 },
                    { name: "Cordarone", dose: "30 days tablets", timing: "", stock: 30, originalStock: 30 },
                    { name: "Orofer XT", dose: "30 tablets", timing: "", stock: 30, originalStock: 30 },
                    { name: "Hyqvit", dose: "30 tablets", timing: "", stock: 30, originalStock: 30 }
                ],
                afternoon: [
                    { name: "Acitrom", dose: "1mg/2mg alternate days", timing: "4pm", stock: 30, originalStock: 30 }
                ],
                afterDinner: [
                    { name: "Rotin F", dose: "30 tablets", timing: "", stock: 30, originalStock: 30 },
                    { name: "Telmiford", dose: "40mg", timing: "30 tablets", stock: 30, originalStock: 30 }
                ]
            },
            mother: {
                afterBreakfast: [
                    { name: "Telzox H", dose: "30 tablets", timing: "", stock: 30, originalStock: 30 },
                    { name: "Cinod", dose: "10mg", timing: "After breakfast and dinner", stock: 60, originalStock: 60 },
                    { name: "Zavamet", dose: "50/500", timing: "After breakfast and dinner", stock: 60, originalStock: 60 }
                ],
                afterDinner: [
                    { name: "Cinod", dose: "10mg", timing: "After breakfast and dinner", stock: 60, originalStock: 60 },
                    { name: "Zavamet", dose: "50/500", timing: "After breakfast and dinner", stock: 60, originalStock: 60 }
                ]
            }
        };

        // Load saved data from memory
        let savedData = null;
        
        function saveData() {
            savedData = JSON.parse(JSON.stringify(medicineData));
        }

        function loadData() {
            if (savedData) {
                Object.assign(medicineData, JSON.parse(JSON.stringify(savedData)));
            }
        }

        // Initialize the app
        function initApp() {
            loadData();
            renderFatherMedicines();
            renderMotherMedicines();
            
            // Show install prompt on mobile
            if (isMobile() && !isAppInstalled()) {
                setTimeout(() => {
                    document.getElementById('installPrompt').style.display = 'block';
                }, 2000);
            }
        }

        function isMobile() {
            return /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);
        }

        function isAppInstalled() {
            return window.matchMedia('(display-mode: standalone)').matches;
        }

        function switchTab(tab) {
            // Remove active class from all tabs and sections
            document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
            document.querySelectorAll('.person-section').forEach(s => s.classList.remove('active'));
            
            // Add active class to clicked tab and corresponding section
            event.target.classList.add('active');
            document.getElementById(tab).classList.add('active');
        }

        function renderFatherMedicines() {
            const fatherSection = document.getElementById('father');
            fatherSection.innerHTML = '';

            const timeSlots = [
                { key: 'morning', title: 'üåÖ Morning (Before Breakfast)', icon: 'üåÖ' },
                { key: 'afterBreakfast', title: 'ü•û After Breakfast', icon: 'ü•û' },
                { key: 'afternoon', title: '‚òÄÔ∏è Afternoon (4 PM)', icon: '‚òÄÔ∏è' },
                { key: 'afterDinner', title: 'üåô After Dinner', icon: 'üåô' }
            ];

            timeSlots.forEach(slot => {
                if (medicineData.father[slot.key] && medicineData.father[slot.key].length > 0) {
                    const slotDiv = document.createElement('div');
                    slotDiv.className = 'time-slot';
                    slotDiv.innerHTML = `<h3>${slot.icon} ${slot.title.replace(slot.icon + ' ', '')}</h3>`;

                    medicineData.father[slot.key].forEach((medicine, index) => {
                        const medicineDiv = createMedicineItem(medicine, 'father', slot.key, index);
                        slotDiv.appendChild(medicineDiv);
                    });

                    fatherSection.appendChild(slotDiv);
                }
            });
        }

        function renderMotherMedicines() {
            const motherSection = document.getElementById('mother');
            motherSection.innerHTML = '';

            const timeSlots = [
                { key: 'afterBreakfast', title: 'ü•û After Breakfast', icon: 'ü•û' },
                { key: 'afterDinner', title: 'üåô After Dinner', icon: 'üåô' }
            ];

            timeSlots.forEach(slot => {
                if (medicineData.mother[slot.key] && medicineData.mother[slot.key].length > 0) {
                    const slotDiv = document.createElement('div');
                    slotDiv.className = 'time-slot';
                    slotDiv.innerHTML = `<h3>${slot.icon} ${slot.title.replace(slot.icon + ' ', '')}</h3>`;

                    // Handle duplicate medicines for mother (Cinod and Zavamet appear in both slots)
                    const uniqueMedicines = slot.key === 'afterDinner' ? 
                        medicineData.mother[slot.key].filter(med => med.timing.includes('dinner')) :
                        medicineData.mother[slot.key];

                    uniqueMedicines.forEach((medicine, index) => {
                        const medicineDiv = createMedicineItem(medicine, 'mother', slot.key, index);
                        slotDiv.appendChild(medicineDiv);
                    });

                    motherSection.appendChild(slotDiv);
                }
            });
        }

        function createMedicineItem(medicine, person, slot, index) {
            const isLowStock = medicine.stock <= 1;
            const medicineDiv = document.createElement('div');
            medicineDiv.className = `medicine-item ${isLowStock ? 'low-stock' : ''}`;
            
            medicineDiv.innerHTML = `
                <div class="medicine-header">
                    <div class="medicine-name">${medicine.name}</div>
                    <div class="stock-count ${isLowStock ? 'low' : ''}">
                        ${medicine.stock} ${isLowStock ? '‚ö†Ô∏è' : 'üíä'}
                    </div>
                </div>
                <div class="medicine-details">
                    ${medicine.dose} ${medicine.timing ? '‚Ä¢ ' + medicine.timing : ''}
                </div>
                <div class="action-buttons">
                    <button class="btn btn-take" onclick="takeMedicine('${person}', '${slot}', ${index})">
                        ‚úÖ Take Medicine
                    </button>
                    <button class="btn btn-calendar" onclick="addToCalendar('${medicine.name}', '${slot}')">
                        üìÖ Add to Calendar
                    </button>
                </div>
            `;

            return medicineDiv;
        }

        function takeMedicine(person, slot, index) {
            if (medicineData[person][slot][index].stock > 0) {
                medicineData[person][slot][index].stock--;
                saveData();
                
                const medicineName = medicineData[person][slot][index].name;
                const remainingStock = medicineData[person][slot][index].stock;
                
                if (remainingStock <= 1) {
                    showNotification(`‚ö†Ô∏è Low stock alert! ${medicineName} has only ${remainingStock} dose${remainingStock === 1 ? '' : 's'} left!`, 'error');
                } else {
                    showNotification(`‚úÖ ${medicineName} taken successfully! ${remainingStock} doses remaining.`);
                }
                
                // Re-render the appropriate section
                if (person === 'father') {
                    renderFatherMedicines();
                } else {
                    renderMotherMedicines();
                }
            } else {
                showNotification(`‚ùå No stock left for this medicine! Please refill.`, 'error');
            }
        }

        function addToCalendar(medicineName, slot) {
            const now = new Date();
            const title = `Take ${medicineName}`;
            const details = `Medicine reminder for ${medicineName}`;
            
            // Create calendar event URL
            const calendarUrl = `https://calendar.google.com/calendar/render?action=TEMPLATE&text=${encodeURIComponent(title)}&details=${encodeURIComponent(details)}&dates=${now.toISOString().replace(/[-:]/g, '').split('.')[0]}Z/${now.toISOString().replace(/[-:]/g, '').split('.')[0]}Z`;
            
            window.open(calendarUrl, '_blank');
            showNotification(`üìÖ Calendar event created for ${medicineName}!`);
        }

        function resetAllStock() {
            if (confirm('Are you sure you want to reset all medicine stock to original quantities?')) {
                Object.keys(medicineData).forEach(person => {
                    Object.keys(medicineData[person]).forEach(slot => {
                        medicineData[person][slot].forEach(medicine => {
                            medicine.stock = medicine.originalStock;
                        });
                    });
                });
                
                saveData();
                renderFatherMedicines();
                renderMotherMedicines();
                showNotification('üîÑ All medicine stock has been reset successfully!');
            }
        }

        let isListening = false;
        let recognition;

        function toggleVoiceAssistant() {
            if (isListening) {
                stopListening();
            } else {
                startListening();
            }
        }

        function startListening() {
            if ('webkitSpeechRecognition' in window) {
                recognition = new webkitSpeechRecognition();
                recognition.continuous = false;
                recognition.interimResults = false;
                recognition.lang = 'en-US';

                recognition.onstart = function() {
                    isListening = true;
                    document.getElementById('voiceBtn').classList.add('listening');
                    document.getElementById('voiceOutput').style.display = 'block';
                    document.getElementById('voiceText').textContent = 'Listening... Speak now!';
                };

                recognition.onresult = function(event) {
                    const command = event.results[0][0].transcript.toLowerCase();
                    document.getElementById('voiceText').textContent = `You said: "${command}"`;
                    processVoiceCommand(command);
                };

                recognition.onerror = function(event) {
                    document.getElementById('voiceText').textContent = 'Sorry, I couldn\'t hear you clearly. Please try again.';
                    stopListening();
                };

                recognition.onend = function() {
                    stopListening();
                };

                recognition.start();
            } else {
                showNotification('‚ùå Voice recognition not supported in this browser', 'error');
            }
        }

        function stopListening() {
            isListening = false;
            document.getElementById('voiceBtn').classList.remove('listening');
            if (recognition) {
                recognition.stop();
            }
        }

        function processVoiceCommand(command) {
            let response = "I'm sorry, I didn't understand that command.";

            if (command.includes('stock') || command.includes('how many')) {
                response = getStockInfo(command);
            } else if (command.includes('father') && command.includes('medicine')) {
                response = getFatherMedicineInfo();
            } else if (command.includes('mother') && command.includes('medicine')) {
                response = getMotherMedicineInfo();
            } else if (command.includes('low stock') || command.includes('refill')) {
                response = getLowStockInfo();
            } else if (command.includes('what is') || command.includes('tell me about')) {
                response = getMedicineInfo(command);
            } else if (command.includes('reminder') || command.includes('remind')) {
                response = "I've noted that you want reminders. You can add specific medicines to your calendar using the calendar button on each medicine.";
            } else if (command.includes('help')) {
                response = "I can help you check medicine stock, get information about medicines, check for low stock alerts, and provide general assistance with your medication management.";
            }

            setTimeout(() => {
                document.getElementById('voiceText').innerHTML = `<strong>Assistant:</strong> ${response}`;
                speakResponse(response);
            }, 1000);
        }

        function getStockInfo(command) {
            let info = "Current stock levels:\n\n";
            
            // Father's medicines
            info += "üë®‚Äç‚öïÔ∏è Father's medicines:\n";
            Object.keys(medicineData.father).forEach(slot => {
                medicineData.father[slot].forEach(med => {
                    info += `‚Ä¢ ${med.name}: ${med.stock} remaining\n`;
                });
            });
            
            info += "\nüë©‚Äç‚öïÔ∏è Mother's medicines:\n";
            Object.keys(medicineData.mother).forEach(slot => {
                const uniqueMeds = medicineData.mother[slot].filter((med, index, arr) => 
                    arr.findIndex(m => m.name === med.name) === index);
                uniqueMeds.forEach(med => {
                    info += `‚Ä¢ ${med.name}: ${med.stock} remaining\n`;
                });
            });
            
            return info;
        }

        function getFatherMedicineInfo() {
            let info = "üë®‚Äç‚öïÔ∏è Father's medicine schedule:\n\n";
            info += "üåÖ Morning (Before breakfast): Maxi PhD\n";
            info += "ü•û After breakfast: Metolol MF, Pilclop, Cordarone, Orofer XT, Hyqvit\n";
            info += "‚òÄÔ∏è Afternoon (4pm): Acitrom (alternate days)\n";
            info += "üåô After dinner: Rotin F, Telmiford\n";
            return info;
        }

        function getMotherMedicineInfo() {
            let info = "üë©‚Äç‚öïÔ∏è Mother's medicine schedule:\n\n";
            info += "ü•û After breakfast: Telzox H, Cinod, Zavamet\n";
            info += "üåô After dinner: Cinod, Zavamet\n";
            return info;
        }

        function getLowStockInfo() {
            let lowStockMeds = [];
            
            // Check father's medicines
            Object.keys(medicineData.father).forEach(slot => {
                medicineData.father[slot].forEach(med => {
                    if (med.stock <= 1) {
                        lowStockMeds.push(`${med.name} (Father) - ${med.stock} left`);
                    }
                });
            });
            
            // Check mother's medicines
            Object.keys(medicineData.mother).forEach(slot => {
                const uniqueMeds = medicineData.mother[slot].filter((med, index, arr) => 
                    arr.findIndex(m => m.name === med.name) === index);
                uniqueMeds.forEach(med => {
                    if (med.stock <= 1) {
                        lowStockMeds.push(`${med.name} (Mother) - ${med.stock} left`);
                    }
                });
            });
            
            if (lowStockMeds.length === 0) {
                return "‚úÖ Great! All medicines have sufficient stock.";
            } else {
                return "‚ö†Ô∏è Low stock alert! These medicines need refilling:\n" + lowStockMeds.join('\n');
            }
        }

        function getMedicineInfo(command) {
            // Basic medicine information database
            const medicineInfo = {
                'metolol': 'Metolol MF is a beta-blocker used to treat high blood pressure and heart conditions.',
                'pilclop': 'Pilclop is an antiplatelet medication that helps prevent blood clots.',
                'cordarone': 'Cordarone (Amiodarone) is used to treat irregular heartbeat (arrhythmia).',
                'orofer': 'Orofer XT is an iron supplement used to treat iron deficiency anemia.',
                'hyqvit': 'Hyqvit is a multivitamin supplement.',
                'acitrom': 'Acitrom is a blood thinner (anticoagulant) that helps prevent blood clots.',
                'rotin': 'Rotin F is a cholesterol-lowering medication (statin).',
                'telmiford': 'Telmiford contains Telmisartan, used to treat high blood pressure.',
                'telzox': 'Telzox H is a combination medication for high blood pressure.',
                'cinod': 'Cinod is used to treat high blood pressure.',
                'zavamet': 'Zavamet is a combination medication for diabetes management.',
                'maxi': 'Maxi PhD is a nutritional supplement.'
            };
            
            const searchTerm = command.replace(/what is|tell me about|about/g, '').trim().toLowerCase();
            
            for (let med in medicineInfo) {
                if (searchTerm.includes(med)) {
                    return medicineInfo[med];
                }
            }
            
            return "I don't have specific information about that medicine. Please consult with a healthcare professional for detailed information.";
        }

        function speakResponse(text) {
            if ('speechSynthesis' in window) {
                const utterance = new SpeechSynthesisUtterance(text);
                utterance.rate = 0.8;
                utterance.pitch = 1;
                utterance.volume = 0.8;
                speechSynthesis.speak(utterance);
            }
        }

        function closeVoiceOutput() {
            document.getElementById('voiceOutput').style.display = 'none';
        }

        function showNotification(message, type = 'success') {
            const notification = document.getElementById('notification');
            notification.textContent = message;
            notification.className = `notification ${type === 'error' ? 'error' : ''}`;
            notification.classList.add('show');
            
            setTimeout(() => {
                notification.classList.remove('show');
            }, 4000);
        }

        function showInstallInstructions() {
            alert(`üì± To add this app to your home screen:

Android Chrome:
1. Tap the menu button (‚ãÆ)
2. Select "Add to Home screen"
3. Tap "Add"

iPhone Safari:
1. Tap the share button (‚ñ°‚Üë)
2. Scroll down and tap "Add to Home Screen"
3. Tap "Add"

The app will then work like a native app on your phone!`);
        }

        function hideInstallPrompt() {
            document.getElementById('installPrompt').style.display = 'none';
        }

        // Service Worker for PWA functionality
        if ('serviceWorker' in navigator) {
            navigator.serviceWorker.register('data:application/javascript;base64,' + btoa(`
                const CACHE_NAME = 'medicine-reminder-v1';
                const urlsToCache = ['/'];

                self.addEventListener('install', function(event) {
                    event.waitUntil(
                        caches.open(CACHE_NAME)
                            .then(function(cache) {
                                return cache.addAll(urlsToCache);
                            })
                    );
                });

                self.addEventListener('fetch', function(event) {
                    event.respondWith(
                        caches.match(event.request)
                            .then(function(response) {
                                if (response) {
                                    return response;
                                }
                                return fetch(event.request);
                            }
                        )
                    );
                });
            `));
        }

        // Initialize app when page loads
        document.addEventListener('DOMContentLoaded', initApp);

        // Auto-save data every 30 seconds
        setInterval(saveData, 30000);

        // Daily reminder check (simplified for demo)
        function checkDailyReminders() {
            const now = new Date();
            const hour = now.getHours();
            
            // Morning reminder (8 AM)
            if (hour === 8) {
                showNotification('üåÖ Morning medicine reminder for Father!', 'error');
            }
            
            // Afternoon reminder (4 PM) 
            if (hour === 16) {
                showNotification('‚òÄÔ∏è Afternoon Acitrom reminder for Father!', 'error');
            }
            
            // Evening reminder (8 PM)
            if (hour === 20) {
                showNotification('üåô Evening medicine reminder!', 'error');
            }
        }

        // Check reminders every hour
        setInterval(checkDailyReminders, 3600000);

        // Prevent zoom on double tap (mobile optimization)
        let lastTouchEnd = 0;
        document.addEventListener('touchend', function (event) {
            const now = (new Date()).getTime();
            if (now - lastTouchEnd <= 300) {
                event.preventDefault();
            }
            lastTouchEnd = now;
        }, false);
    </script>
</body>
</html>